import{ar as be,a9 as fe,u as ge,v as Ie,e as I,O as Be,I as ye,j as P,ab as ke,ac as he,K as p,w as l,r as i,a7 as Ee,n as Ce,o as b,a,ae as D,L as w,q as v,t as _,M as k,af as T,l as u,V as f,b as g,a8 as j,aW as G}from"./main-BfksJgUh.js";import{_ as Ve}from"./MoonwalkerIcon-Sc-E1onJ.js";import{_ as De}from"./InvoiceIndexDropdown-BwGcB5bp.js";import{_ as Te}from"./SendInvoiceModal-Dl2CvmN8.js";import"./mail-driver-W17sMozV.js";const $e={class:"relative table-container"},Ae={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Se={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Pe={class:"absolute items-center left-6 top-2.5 select-none"},we={class:"relative block"},Fe={class:"flex justify-between"},Me={__name:"Index",setup(Ne){const r=be(),H=fe();ge();const{t:s}=Ie.useI18n();Ee("$utils");const h=I(null),F=I(0),B=I(!1),q=I([{label:s("invoices.status"),options:[{label:s("general.draft"),value:"DRAFT"},{label:s("general.due"),value:"DUE"},{label:s("general.sent"),value:"SENT"},{label:s("invoices.viewed"),value:"VIEWED"},{label:s("invoices.completed"),value:"COMPLETED"}]},{label:s("invoices.paid_status"),options:[{label:s("invoices.unpaid"),value:"UNPAID"},{label:s("invoices.paid"),value:"PAID"},{label:s("invoices.partially_paid"),value:"PARTIALLY_PAID"}]},,]),$=I(!0),c=I("general.draft");Ce();const E=Be();let n=ye({customer_id:"",status:"",from_date:"",to_date:"",invoice_number:""});const N=P(()=>!r.invoiceTotalCount&&!$.value),U=P({get:()=>r.selectedInvoices,set:t=>r.selectInvoice(t)}),z=P(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:s("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:s("invoices.number")},{key:"name",label:s("invoices.customer")},{key:"status",label:s("invoices.status")},{key:"due_amount",label:s("dashboard.recent_invoices_card.amount_due")},{key:"total",label:s("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:s("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);ke(n,()=>{Q()},{debounce:500}),he(()=>{r.selectAllField&&r.selectAllInvoices()});function K(){return E.hasAbilities([f.DELETE_INVOICE,f.EDIT_INVOICE,f.VIEW_INVOICE,f.SEND_INVOICE])}async function Y(t,o){n.status="",A()}function A(){h.value&&h.value.refresh()}async function X({page:t,filter:o,sort:m}){let C={customer_id:n.customer_id,status:n.status,from_date:n.from_date,to_date:n.to_date,invoice_number:n.invoice_number,orderByField:m.fieldName||"created_at",orderBy:m.order||"desc",page:t};console.log(C),$.value=!0;let d=await r.fetchInvoices(C);return console.log("API response:",d.data.data),$.value=!1,{data:d.data.data,pagination:{totalPages:d.data.meta.last_page,currentPage:t,totalCount:d.data.meta.total,limit:10}}}function J(t){if(c.value==t.title)return!0;switch(c.value=t.title,t.title){case s("general.draft"):n.status="DRAFT";break;case s("general.sent"):n.status="SENT";break;case s("general.due"):n.status="DUE";break;default:n.status="";break}}function Q(){r.$patch(t=>{t.selectedInvoices=[],t.selectAllField=!1}),F.value+=1,A()}function O(){n.customer_id="",n.status="",n.from_date="",n.to_date="",n.invoice_number="",c.value=s("general.all")}async function Z(){H.openDialog({title:s("general.are_you_sure"),message:s("invoices.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async t=>{t&&await r.deleteMultipleInvoices().then(o=>{o.data.success&&(A(),r.$patch(m=>{m.selectedInvoices=[],m.selectAllField=!1}))})})}function ee(){B.value&&O(),B.value=!B.value}function ae(t){switch(t){case"DRAFT":c.value=s("general.draft");break;case"SENT":c.value=s("general.sent");break;case"DUE":c.value=s("general.due");break;case"COMPLETED":c.value=s("invoices.completed");break;case"PAID":c.value=s("invoices.paid");break;case"UNPAID":c.value=s("invoices.unpaid");break;case"PARTIALLY_PAID":c.value=s("invoices.partially_paid");break;case"VIEWED":c.value=s("invoices.viewed");break;default:c.value=s("general.all");break}}return(t,o)=>{const m=i("BaseBreadcrumbItem"),C=i("BaseBreadcrumb"),d=i("BaseIcon"),S=i("BaseButton"),R=i("router-link"),te=i("BasePageHeader"),le=i("BaseCustomerSelectInput"),y=i("BaseInputGroup"),se=i("BaseMultiselect"),x=i("BaseDatePicker"),ne=i("BaseInput"),oe=i("BaseFilterWrapper"),ie=i("BaseEmptyPlaceholder"),V=i("BaseTab"),ue=i("BaseTabGroup"),re=i("BaseDropdownItem"),ce=i("BaseDropdown"),L=i("BaseCheckbox"),de=i("BaseText"),M=i("BaseFormatMoney"),me=i("BaseInvoiceStatusBadge"),W=i("BasePaidStatusBadge"),ve=i("BaseTable"),_e=i("BasePage");return b(),p(_e,null,{default:l(()=>[a(Te),a(te,{title:t.$t("invoices.title")},{actions:l(()=>[D(a(S,{variant:"primary-outline",onClick:ee},{right:l(e=>[B.value?(b(),p(d,{key:1,name:"XMarkIcon",class:k(e.class)},null,8,["class"])):(b(),p(d,{key:0,name:"FunnelIcon",class:k(e.class)},null,8,["class"]))]),default:l(()=>[v(_(t.$t("general.filter"))+" ",1)]),_:1},512),[[T,u(r).invoiceTotalCount]]),u(E).hasAbilities(u(f).CREATE_INVOICE)?(b(),p(R,{key:0,to:"invoices/create"},{default:l(()=>[a(S,{variant:"primary",class:"ml-4"},{left:l(e=>[a(d,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:l(()=>[v(" "+_(t.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):w("",!0)]),default:l(()=>[a(C,null,{default:l(()=>[a(m,{title:t.$t("general.home"),to:"dashboard"},null,8,["title"]),a(m,{title:t.$t("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),D(a(oe,{"row-on-xl":!0,onClear:O},{default:l(()=>[a(y,{label:t.$t("customers.customer",1)},{default:l(()=>[a(le,{modelValue:u(n).customer_id,"onUpdate:modelValue":o[0]||(o[0]=e=>u(n).customer_id=e),placeholder:t.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(y,{label:t.$t("invoices.status")},{default:l(()=>[a(se,{modelValue:u(n).status,"onUpdate:modelValue":[o[1]||(o[1]=e=>u(n).status=e),ae],groups:!0,options:q.value,searchable:"",placeholder:t.$t("general.select_a_status"),onRemove:o[2]||(o[2]=e=>Y())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),a(y,{label:t.$t("general.from")},{default:l(()=>[a(x,{modelValue:u(n).from_date,"onUpdate:modelValue":o[3]||(o[3]=e=>u(n).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),o[9]||(o[9]=g("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1)),a(y,{label:t.$t("general.to"),class:"mt-2"},{default:l(()=>[a(x,{modelValue:u(n).to_date,"onUpdate:modelValue":o[4]||(o[4]=e=>u(n).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),a(y,{label:t.$t("invoices.invoice_number")},{default:l(()=>[a(ne,{modelValue:u(n).invoice_number,"onUpdate:modelValue":o[5]||(o[5]=e=>u(n).invoice_number=e)},{left:l(e=>[a(d,{name:"HashtagIcon",class:k(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[T,B.value]]),D(a(ie,{title:t.$t("invoices.no_invoices"),description:t.$t("invoices.list_of_invoices")},j({default:l(()=>[a(Ve,{class:"mt-5 mb-4"})]),_:2},[u(E).hasAbilities(u(f).CREATE_INVOICE)?{name:"actions",fn:l(()=>[a(S,{variant:"primary-outline",onClick:o[6]||(o[6]=e=>t.$router.push("/admin/invoices/create"))},{left:l(e=>[a(d,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:l(()=>[v(" "+_(t.$t("invoices.add_new_invoice")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"]),[[T,N.value]]),D(g("div",$e,[g("div",Ae,[a(ue,{class:"-mb-5",onChange:J},{default:l(()=>[a(V,{title:t.$t("general.all"),filter:""},null,8,["title"]),a(V,{title:t.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),a(V,{title:t.$t("general.sent"),filter:"SENT"},null,8,["title"]),a(V,{title:t.$t("general.due"),filter:"DUE"},null,8,["title"])]),_:1}),u(r).selectedInvoices.length&&u(E).hasAbilities(u(f).DELETE_INVOICE)?(b(),p(ce,{key:0,class:"absolute float-right"},{activator:l(()=>[g("span",Se,[v(_(t.$t("general.actions"))+" ",1),a(d,{name:"ChevronDownIcon"})])]),default:l(()=>[a(re,{onClick:Z},{default:l(()=>[a(d,{name:"TrashIcon",class:"mr-3 text-gray-600"}),v(" "+_(t.$t("general.delete")),1)]),_:1})]),_:1})):w("",!0)]),(b(),p(ve,{ref_key:"table",ref:h,data:X,columns:z.value,"placeholder-count":u(r).invoiceTotalCount>=20?10:5,key:F.value,class:"mt-10"},j({header:l(()=>[g("div",Pe,[a(L,{modelValue:u(r).selectAllField,"onUpdate:modelValue":o[7]||(o[7]=e=>u(r).selectAllField=e),variant:"primary",onChange:u(r).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":l(({row:e})=>[g("div",we,[a(L,{id:e.id,modelValue:U.value,"onUpdate:modelValue":o[8]||(o[8]=pe=>U.value=pe),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":l(({row:e})=>[a(de,{text:e.data.customer.name},null,8,["text"])]),"cell-invoice_number":l(({row:e})=>[a(R,{to:{path:`invoices/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[v(_(e.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":l(({row:e})=>[v(_(e.data.formatted_invoice_date),1)]),"cell-total":l(({row:e})=>[a(M,{amount:e.data.total,currency:e.data.customer.currency},null,8,["amount","currency"])]),"cell-status":l(({row:e})=>[a(me,{status:e.data.status,class:"px-3 py-1"},{default:l(()=>[a(G,{status:e.data.status},null,8,["status"])]),_:2},1032,["status"])]),"cell-due_amount":l(({row:e})=>[g("div",Fe,[a(M,{amount:e.data.due_amount,currency:e.data.currency},null,8,["amount","currency"]),e.data.overdue?(b(),p(W,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:l(()=>[v(_(t.$t("invoices.overdue")),1)]),_:1})):w("",!0),a(W,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:l(()=>[a(G,{status:e.data.paid_status},null,8,["status"])]),_:2},1032,["status"])])]),_:2},[K()?{name:"cell-actions",fn:l(({row:e})=>[a(De,{row:e.data,table:h.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns","placeholder-count"]))],512),[[T,!N.value]])]),_:1})}}};export{Me as default};
