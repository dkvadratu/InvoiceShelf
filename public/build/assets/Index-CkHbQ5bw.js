import{v as Q,e as B,I as Y,j as E,ab as Z,K as c,w as t,r as s,a7 as ee,N as te,o as d,a as e,ae as D,L as S,l as p,q as g,t as v,M as C,b as x,af as F}from"./main-h7MY4IwZ.js";import ae from"./BaseTable-CBxV1JaJ.js";import{u as se}from"./global-Ci3lE4L6.js";import{u as le}from"./estimate-DsMI5sTu.js";import{_ as oe}from"./ObservatoryIcon-j4pOrHJ_.js";import"./auth-DN2FYAZa.js";const ne={class:"relative table-container"},_e={__name:"Index",setup(re){const{t:r}=Q.useI18n();ee("utils"),te();const I=B(null);let u=B(!1),y=B(!0);const P=B([{label:r("estimates.draft"),value:"DRAFT"},{label:r("estimates.sent"),value:"SENT"},{label:r("estimates.viewed"),value:"VIEWED"},{label:r("estimates.expired"),value:"EXPIRED"},{label:r("estimates.accepted"),value:"ACCEPTED"},{label:r("estimates.rejected"),value:"REJECTED"}]),l=Y({status:"",from_date:"",to_date:"",estimate_number:""}),h=se(),_=le(),N=E(()=>[{key:"estimate_date",label:r("estimates.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"estimate_number",label:r("estimates.number",2)},{key:"status",label:r("estimates.status")},{key:"total",label:r("estimates.total")},{key:"actions",thClass:"text-right",tdClass:"text-right text-sm font-medium",sortable:!1}]),k=E(()=>!_.totalEstimates&&!y.value);E(()=>h.currency),Z(l,()=>{H()},{debounce:500});function T(){I.value.refresh()}function H(){T()}function w(){l.status="",l.from_date="",l.to_date="",l.estimate_number=""}function j(){u.value&&w(),u.value=!u.value}async function M({page:o,sort:n}){let f={status:l.status.value,estimate_number:l.estimate_number,from_date:l.from_date,to_date:l.to_date,orderByField:n.fieldName||"created_at",orderBy:n.order||"desc",page:o};y.value=!0;let i=await _.fetchEstimate(f,h.companySlug);return y.value=!1,{data:i.data.data,pagination:{totalPages:i.data.meta.last_page,currentPage:o,totalCount:i.data.meta.total,limit:10}}}return(o,n)=>{const f=s("BaseBreadcrumbItem"),i=s("BaseBreadcrumb"),m=s("BaseIcon"),R=s("BaseButton"),U=s("BasePageHeader"),z=s("BaseSelectInput"),b=s("BaseInputGroup"),G=s("BaseInput"),V=s("BaseDatePicker"),L=s("BaseFilterWrapper"),W=s("BaseEmptyPlaceholder"),$=s("router-link"),A=s("BaseEstimateStatusLabel"),X=s("BaseEstimateStatusBadge"),q=s("BaseFormatMoney"),J=s("BaseDropdownItem"),K=s("BaseDropdown"),O=s("BasePage");return d(),c(O,null,{default:t(()=>[e(U,{title:o.$t("estimates.title")},{actions:t(()=>[p(_).totalEstimates?(d(),c(R,{key:0,variant:"primary-outline",onClick:j},{right:t(a=>[p(u)?(d(),c(m,{key:1,name:"XMarkIcon",class:C(a.class)},null,8,["class"])):(d(),c(m,{key:0,name:"FunnelIcon",class:C(a.class)},null,8,["class"]))]),default:t(()=>[g(v(o.$t("general.filter"))+" ",1)]),_:1})):S("",!0)]),default:t(()=>[e(i,null,{default:t(()=>[e(f,{title:o.$t("general.home"),to:`/${p(h).companySlug}/customer/dashboard`},null,8,["title","to"]),e(f,{title:o.$t("estimates.estimate",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),D(e(L,{onClear:w},{default:t(()=>[e(b,{label:o.$t("estimates.status"),class:"px-3"},{default:t(()=>[e(z,{modelValue:l.status,"onUpdate:modelValue":n[0]||(n[0]=a=>l.status=a),options:P.value,searchable:"","show-labels":!1,"allow-empty":!1,placeholder:o.$t("general.select_a_status")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),e(b,{label:o.$t("estimates.estimate_number"),color:"black-light",class:"px-3 mt-2"},{default:t(()=>[e(G,{modelValue:l.estimate_number,"onUpdate:modelValue":n[1]||(n[1]=a=>l.estimate_number=a)},{default:t(()=>[e(m,{name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"}),e(m,{name:"HashtagIcon",class:"h-5 mr-3 text-gray-600"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(b,{label:o.$t("general.from"),class:"px-3"},{default:t(()=>[e(V,{modelValue:l.from_date,"onUpdate:modelValue":n[2]||(n[2]=a=>l.from_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),n[4]||(n[4]=x("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1)),e(b,{label:o.$t("general.to"),class:"px-3"},{default:t(()=>[e(V,{modelValue:l.to_date,"onUpdate:modelValue":n[3]||(n[3]=a=>l.to_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[F,p(u)]]),k.value?(d(),c(W,{key:0,title:o.$t("estimates.no_estimates"),description:o.$t("estimates.list_of_estimates")},{default:t(()=>[e(oe,{class:"mt-5 mb-4"})]),_:1},8,["title","description"])):S("",!0),D(x("div",ne,[e(ae,{ref_key:"table",ref:I,data:M,columns:N.value,"placeholder-count":p(_).totalEstimates>=20?10:5,class:"mt-10"},{"cell-estimate_date":t(({row:a})=>[g(v(a.data.formatted_estimate_date),1)]),"cell-estimate_number":t(({row:a})=>[e($,{to:{path:`estimates/${a.data.id}/view`},class:"font-medium text-primary-500"},{default:t(()=>[g(v(a.data.estimate_number),1)]),_:2},1032,["to"])]),"cell-status":t(({row:a})=>[e(X,{status:a.data.status,class:"px-3 py-1"},{default:t(()=>[e(A,{status:a.data.status},null,8,["status"])]),_:2},1032,["status"])]),"cell-total":t(({row:a})=>[e(q,{amount:a.data.total},null,8,["amount"])]),"cell-actions":t(({row:a})=>[e(K,null,{activator:t(()=>[e(m,{name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"})]),default:t(()=>[e($,{to:`estimates/${a.data.id}/view`},{default:t(()=>[e(J,null,{default:t(()=>[e(m,{name:"EyeIcon",class:"h-5 mr-3 text-gray-600"}),g(" "+v(o.$t("general.view")),1)]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:1},8,["columns","placeholder-count"])],512),[[F,!k.value]])]),_:1})}}};export{_e as default};
