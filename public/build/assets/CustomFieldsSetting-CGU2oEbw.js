const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DateTimeType-D88v_0wx.js","assets/main-Cl8j3Vhg.js","assets/main-CRSU5Ycv.css","assets/DateType-BLfupUdr.js","assets/DropdownType-XBmJn8LV.js","assets/InputType-Cyrw4m5l.js","assets/NumberType-B__2pcNs.js","assets/PhoneType-DKTyxtQ1.js","assets/SwitchType-BKvQe-KB.js","assets/TextAreaType-DwDK8jLt.js","assets/TimeType-yLoNoQ3D.js","assets/UrlType-B_cw2AZ9.js"])))=>i.map(i=>d[i]);
import{a9 as ae,u as ne,v as z,ag as G,N as re,O as Z,G as K,a7 as ee,r as d,K as F,o as C,w as r,L as q,l as e,V as L,a as s,q as I,t as w,e as P,c as j,ax as ue,m as te,I as W,j as T,ay as ie,az as b,f as M,g as A,as as de,i as me,b as k,p as ce,Q as pe,R as _e,M as H,a5 as fe,a8 as ve}from"./main-Cl8j3Vhg.js";import{_ as ye}from"./dynamic-import-helper-BheWnx7M.js";const Ce={__name:"CustomFieldIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(h){const f=h,t=ae();ne();const{t:a}=z.useI18n(),_=G();re();const i=Z(),m=K();ee("utils");async function p(y){await _.fetchCustomField(y),m.openModal({title:a("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:y,refreshData:f.loadData})}async function B(y){t.openDialog({title:a("general.are_you_sure"),message:a("settings.custom_fields.custom_field_confirm_delete"),yesLabel:a("general.ok"),noLabel:a("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async g=>{g&&(await _.deleteCustomFields(y),f.loadData&&f.loadData())})}return(y,g)=>{const D=d("BaseIcon"),c=d("BaseDropdownItem"),O=d("BaseDropdown");return C(),F(O,null,{activator:r(()=>[s(D,{name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"})]),default:r(()=>[e(i).hasAbilities(e(L).EDIT_CUSTOM_FIELDS)?(C(),F(c,{key:0,onClick:g[0]||(g[0]=o=>p(h.row.id))},{default:r(()=>[s(D,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),I(" "+w(y.$t("general.edit")),1)]),_:1})):q("",!0),e(i).hasAbilities(e(L).DELETE_CUSTOM_FIELDS)?(C(),F(c,{key:1,onClick:g[1]||(g[1]=o=>B(h.row.id))},{default:r(()=>[s(D,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),I(" "+w(y.$t("general.delete")),1)]),_:1})):q("",!0)]),_:1})}}},ge={class:"flex items-center mt-1"},be={__name:"OptionsCreate",emits:["onAdd"],setup(h,{emit:f}){const t=f,a=P(null);function _(){if(a.value==null||a.value==""||a.value==null)return!0;t("onAdd",a.value),a.value=null}return(i,m)=>{const p=d("BaseInput"),B=d("BaseIcon");return C(),j("div",ge,[s(p,{modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=y=>a.value=y),type:"text",class:"w-full md:w-96",placeholder:i.$t("settings.custom_fields.press_enter_to_add"),onClick:_,onKeydown:ue(te(_,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),s(B,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:_})])}}},Fe={class:"flex justify-between w-full"},we={class:"overflow-y-auto max-h-[550px]"},$e={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Ie={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},Te={__name:"CustomFieldModal",setup(h){const f=K(),t=G(),{t:a}=z.useI18n();let _=P(!1);const i=W([{label:a("settings.custom_fields.model_type.customer"),value:"Customer"},{label:a("settings.custom_fields.model_type.invoice"),value:"Invoice"},{label:a("settings.custom_fields.model_type.estimate"),value:"Estimate"},{label:a("settings.custom_fields.model_type.expense"),value:"Expense"},{label:a("settings.custom_fields.model_type.payment"),value:"Payment"}]),m=W([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let p=P(m[0]);const B=T(()=>f.active&&f.componentName==="CustomFieldModal"),y=T(()=>p.value&&p.value.label==="Switch Toggle"),g=T(()=>p.value&&p.value.label==="Select Field"),D=T(()=>t.currentCustomField.type?ie(()=>ye(Object.assign({"../../custom-fields/types/DateTimeType.vue":()=>b(()=>import("./DateTimeType-D88v_0wx.js"),__vite__mapDeps([0,1,2])),"../../custom-fields/types/DateType.vue":()=>b(()=>import("./DateType-BLfupUdr.js"),__vite__mapDeps([3,1,2])),"../../custom-fields/types/DropdownType.vue":()=>b(()=>import("./DropdownType-XBmJn8LV.js"),__vite__mapDeps([4,1,2])),"../../custom-fields/types/InputType.vue":()=>b(()=>import("./InputType-Cyrw4m5l.js"),__vite__mapDeps([5,1,2])),"../../custom-fields/types/NumberType.vue":()=>b(()=>import("./NumberType-B__2pcNs.js"),__vite__mapDeps([6,1,2])),"../../custom-fields/types/PhoneType.vue":()=>b(()=>import("./PhoneType-DKTyxtQ1.js"),__vite__mapDeps([7,1,2])),"../../custom-fields/types/SwitchType.vue":()=>b(()=>import("./SwitchType-BKvQe-KB.js"),__vite__mapDeps([8,1,2])),"../../custom-fields/types/TextAreaType.vue":()=>b(()=>import("./TextAreaType-DwDK8jLt.js"),__vite__mapDeps([9,1,2])),"../../custom-fields/types/TimeType.vue":()=>b(()=>import("./TimeType-yLoNoQ3D.js"),__vite__mapDeps([10,1,2])),"../../custom-fields/types/UrlType.vue":()=>b(()=>import("./UrlType-B_cw2AZ9.js"),__vite__mapDeps([11,1,2]))}),`../../custom-fields/types/${t.currentCustomField.type}Type.vue`,5)):!1),c=T({get:()=>t.currentCustomField.is_required===1,set:l=>{const n=l?1:0;t.currentCustomField.is_required=n}}),O=T(()=>({currentCustomField:{name:{required:M.withMessage(a("validation.required"),A)},label:{required:M.withMessage(a("validation.required"),A)},model_type:{required:M.withMessage(a("validation.required"),A)},order:{required:M.withMessage(a("validation.required"),A),numeric:M.withMessage(a("validation.numbers_only"),de)},type:{required:M.withMessage(a("validation.required"),A)}}})),o=me(O,T(()=>t));function x(){t.isEdit?p.value=m.find(l=>l.value==t.currentCustomField.type):(t.currentCustomField.model_type=i[0],t.currentCustomField.type=m[0].value,p.value=m[0])}async function V(){if(o.value.currentCustomField.$touch(),o.value.currentCustomField.$invalid)return!0;_.value=!0;let l={...t.currentCustomField};if(t.currentCustomField.options&&(l.options=t.currentCustomField.options.map(E=>E.name)),l.type=="Time"&&typeof l.default_answer=="object"){let E=l&&l.default_answer&&l.default_answer.HH?l.default_answer.HH:null,S=l&&l.default_answer&&l.default_answer.mm?l.default_answer.mm:null;l&&l.default_answer&&l.default_answer.ss&&l.default_answer.ss,l.default_answer=`${E}:${S}`}await(t.isEdit?t.updateCustomField:t.addCustomField)(l),_.value=!1,f.refreshData&&f.refreshData(),R()}function U(l){t.currentCustomField.options=[{name:l},...t.currentCustomField.options]}function N(l){if(t.isEdit&&t.currentCustomField.in_use)return;t.currentCustomField.options[l].name===t.currentCustomField.default_answer&&(t.currentCustomField.default_answer=null),t.currentCustomField.options.splice(l,1)}function v(l){t.currentCustomField.type=l.value}function R(){f.closeModal(),setTimeout(()=>{t.resetCurrentCustomField(),o.value.$reset()},300)}return(l,n)=>{const E=d("BaseIcon"),S=d("BaseInput"),$=d("BaseInputGroup"),Y=d("BaseMultiselect"),le=d("BaseSwitch"),se=d("BaseInputGrid"),Q=d("BaseButton"),oe=d("BaseModal");return C(),F(oe,{show:B.value,onOpen:x},{header:r(()=>[k("div",Fe,[I(w(e(f).title)+" ",1),s(E,{name:"XMarkIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:R})])]),default:r(()=>[k("form",{action:"",onSubmit:te(V,["prevent"])},[k("div",we,[k("div",$e,[s(se,{layout:"one-column"},{default:r(()=>[s($,{label:l.$t("settings.custom_fields.name"),required:"",error:e(o).currentCustomField.name.$error&&e(o).currentCustomField.name.$errors[0].$message},{default:r(()=>[s(S,{ref:"name",modelValue:e(t).currentCustomField.name,"onUpdate:modelValue":n[0]||(n[0]=u=>e(t).currentCustomField.name=u),invalid:e(o).currentCustomField.name.$error,onInput:n[1]||(n[1]=u=>e(o).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),s($,{label:l.$t("settings.custom_fields.model"),error:e(o).currentCustomField.model_type.$error&&e(o).currentCustomField.model_type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.model_in_use"):"",required:""},{default:r(()=>[s(Y,{modelValue:e(t).currentCustomField.model_type,"onUpdate:modelValue":n[2]||(n[2]=u=>e(t).currentCustomField.model_type=u),options:i,"value-prop":"value","can-deselect":!1,invalid:e(o).currentCustomField.model_type.$error,searchable:!0,disabled:e(t).currentCustomField.in_use,onInput:n[3]||(n[3]=u=>e(o).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{class:"flex items-center space-x-4",label:l.$t("settings.custom_fields.required")},{default:r(()=>[s(le,{modelValue:c.value,"onUpdate:modelValue":n[4]||(n[4]=u=>c.value=u)},null,8,["modelValue"])]),_:1},8,["label"]),s($,{label:l.$t("settings.custom_fields.type"),error:e(o).currentCustomField.type.$error&&e(o).currentCustomField.type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.type_in_use"):"",required:""},{default:r(()=>[s(Y,{modelValue:e(p),"onUpdate:modelValue":[n[5]||(n[5]=u=>ce(p)?p.value=u:p=u),v],options:m,invalid:e(o).currentCustomField.type.$error,disabled:e(t).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{label:l.$t("settings.custom_fields.label"),required:"",error:e(o).currentCustomField.label.$error&&e(o).currentCustomField.label.$errors[0].$message},{default:r(()=>[s(S,{modelValue:e(t).currentCustomField.label,"onUpdate:modelValue":n[6]||(n[6]=u=>e(t).currentCustomField.label=u),invalid:e(o).currentCustomField.label.$error,onInput:n[7]||(n[7]=u=>e(o).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),g.value?(C(),F($,{key:0,label:l.$t("settings.custom_fields.options")},{default:r(()=>[s(be,{onOnAdd:U}),(C(!0),j(pe,null,_e(e(t).currentCustomField.options,(u,X)=>(C(),j("div",{key:X,class:"flex items-center mt-5"},[s(S,{modelValue:u.name,"onUpdate:modelValue":J=>u.name=J,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),s(E,{name:"MinusCircleIcon",class:H(["ml-1 cursor-pointer",e(t).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:J=>N(X)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):q("",!0),s($,{label:l.$t("settings.custom_fields.default_value"),class:"relative"},{default:r(()=>[(C(),F(fe(D.value),{modelValue:e(t).currentCustomField.default_answer,"onUpdate:modelValue":n[8]||(n[8]=u=>e(t).currentCustomField.default_answer=u),options:e(t).currentCustomField.options,"default-date-time":e(t).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),y.value?q("",!0):(C(),F($,{key:1,label:l.$t("settings.custom_fields.placeholder")},{default:r(()=>[s(S,{modelValue:e(t).currentCustomField.placeholder,"onUpdate:modelValue":n[9]||(n[9]=u=>e(t).currentCustomField.placeholder=u)},null,8,["modelValue"])]),_:1},8,["label"])),s($,{label:l.$t("settings.custom_fields.order"),error:e(o).currentCustomField.order.$error&&e(o).currentCustomField.order.$errors[0].$message,required:""},{default:r(()=>[s(S,{modelValue:e(t).currentCustomField.order,"onUpdate:modelValue":n[10]||(n[10]=u=>e(t).currentCustomField.order=u),type:"number",invalid:e(o).currentCustomField.order.$error,onInput:n[11]||(n[11]=u=>e(o).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),k("div",Ie,[s(Q,{class:"mr-3",type:"button",variant:"primary-outline",onClick:R},{default:r(()=>[I(w(l.$t("general.cancel")),1)]),_:1}),s(Q,{variant:"primary",loading:e(_),disabled:e(_),type:"submit"},{left:r(u=>[e(_)?q("",!0):(C(),F(E,{key:0,class:H(u.class),name:"ArrowDownOnSquareIcon"},null,8,["class"]))]),default:r(()=>[I(" "+w(e(t).isEdit?l.$t("general.update"):l.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],32)]),_:1},8,["show"])}}},Be={class:"text-xs text-gray-500"},Ee={__name:"CustomFieldsSetting",setup(h){const f=K(),t=G(),a=Z(),_=ee("utils"),{t:i}=z.useI18n(),m=P(null),p=T(()=>[{key:"name",label:i("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:i("settings.custom_fields.model")},{key:"type",label:i("settings.custom_fields.type")},{key:"is_required",label:i("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function B({page:c,filter:O,sort:o}){let x={orderByField:o.fieldName||"created_at",orderBy:o.order||"desc",page:c},V=await t.fetchCustomFields(x);return{data:V.data.data,pagination:{totalPages:V.data.meta.last_page,currentPage:c,limit:5,totalCount:V.data.meta.total}}}function y(){f.openModal({title:i("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:m.value&&m.value.refresh})}async function g(){m.value&&m.value.refresh()}function D(c){switch(c){case"Customer":return i("settings.custom_fields.model_type.customer");case"Invoice":return i("settings.custom_fields.model_type.invoice");case"Estimate":return i("settings.custom_fields.model_type.estimate");case"Expense":return i("settings.custom_fields.model_type.expense");case"Payment":return i("settings.custom_fields.model_type.payment");default:return c}}return(c,O)=>{const o=d("BaseIcon"),x=d("BaseButton"),V=d("BaseBadge"),U=d("BaseTable"),N=d("BaseSettingCard");return C(),F(N,{title:c.$t("settings.menu_title.custom_fields"),description:c.$t("settings.custom_fields.section_description")},{action:r(()=>[e(a).hasAbilities(e(L).CREATE_CUSTOM_FIELDS)?(C(),F(x,{key:0,variant:"primary-outline",onClick:y},{left:r(v=>[s(o,{class:H(v.class),name:"PlusIcon"},null,8,["class"]),I(" "+w(c.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):q("",!0)]),default:r(()=>[s(Te),s(U,{ref_key:"table",ref:m,data:B,columns:p.value,class:"mt-16"},ve({"cell-name":r(({row:v})=>[I(w(v.data.name)+" ",1),k("span",Be," ("+w(v.data.slug)+")",1)]),"cell-model_type":r(({row:v})=>[I(w(D(v.data.model_type)),1)]),"cell-is_required":r(({row:v})=>[s(V,{"bg-color":e(_).getBadgeStatusColor(v.data.is_required?"YES":"NO").bgColor,color:e(_).getBadgeStatusColor(v.data.is_required?"YES":"NO").color},{default:r(()=>[I(w(v.data.is_required?c.$t("settings.custom_fields.yes"):c.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[e(a).hasAbilities([e(L).DELETE_CUSTOM_FIELDS,e(L).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:r(({row:v})=>[s(Ce,{row:v.data,table:m.value,"load-data":g},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{Ee as default};
