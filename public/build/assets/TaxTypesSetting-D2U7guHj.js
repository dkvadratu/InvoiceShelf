import{a9 as F,u as U,v as M,av as Y,N as H,O as V,G as z,a7 as j,r as n,K as y,o as p,w as t,L as P,l as i,V as T,a as s,q as w,t as D,F as R,aw as q,e as $,j as A,a8 as N,M as G,c as K}from"./main-CAtQQnL-.js";import{_ as J}from"./TaxTypeModal-BI8DgugD.js";const Q={__name:"TaxTypeIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(S){const a=S,x=F();U();const{t:c}=M.useI18n(),B=Y(),f=H(),b=V(),l=z();j("utils");async function v(r){await B.fetchTaxType(r),l.openModal({title:c("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:a.loadData&&a.loadData})}function E(r){x.openDialog({title:c("general.are_you_sure"),message:c("settings.tax_types.confirm_delete"),yesLabel:c("general.ok"),noLabel:c("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async o=>{if(o){if((await B.deleteTaxType(r)).data.success)return a.loadData&&a.loadData(),!0;a.loadData&&a.loadData()}})}return(r,o)=>{const d=n("BaseIcon"),C=n("BaseButton"),h=n("BaseDropdownItem"),I=n("BaseDropdown");return p(),y(I,null,{activator:t(()=>[i(f).name==="tax-types.view"?(p(),y(C,{key:0,variant:"primary"},{default:t(()=>[s(d,{name:"EllipsisHorizontalIcon",class:"h-5 text-white"})]),_:1})):(p(),y(d,{key:1,name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"}))]),default:t(()=>[i(b).hasAbilities(i(T).EDIT_TAX_TYPE)?(p(),y(h,{key:0,onClick:o[0]||(o[0]=e=>v(S.row.id))},{default:t(()=>[s(d,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),w(" "+D(r.$t("general.edit")),1)]),_:1})):P("",!0),i(b).hasAbilities(i(T).DELETE_TAX_TYPE)?(p(),y(h,{key:1,onClick:o[1]||(o[1]=e=>E(S.row.id))},{default:t(()=>[s(d,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),w(" "+D(r.$t("general.delete")),1)]),_:1})):P("",!0)]),_:1})}}},W={key:0},te={__name:"TaxTypesSetting",setup(S){const{t:a}=M.useI18n();j("utils");const x=R(),c=Y(),B=z(),f=V(),b=q(),l=$(null),v=$(x.selectedCompanySettings.tax_per_item),E=A(()=>[{key:"name",label:a("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"percent",label:a("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),r=A(()=>x.selectedCompanySettings.sales_tax_us_enabled==="YES"&&b.salesTaxUSEnabled),o=A({get:()=>v.value==="YES",set:async e=>{const m=e?"YES":"NO";let _={settings:{tax_per_item:m}};v.value=m,await x.updateCompanySettings({data:_,message:"general.setting_updated"})}});function d(){return f.hasAbilities([T.DELETE_TAX_TYPE,T.EDIT_TAX_TYPE])}async function C({page:e,filter:m,sort:_}){let k={orderByField:_.fieldName||"created_at",orderBy:_.order||"desc",page:e},g=await c.fetchTaxTypes(k);return{data:g.data.data,pagination:{totalPages:g.data.meta.last_page,currentPage:e,totalCount:g.data.meta.total,limit:5}}}async function h(){l.value&&l.value.refresh()}function I(){B.openModal({title:a("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:l.value&&l.value.refresh})}return(e,m)=>{const _=n("BaseIcon"),k=n("BaseButton"),g=n("BaseTable"),L=n("BaseDivider"),O=n("BaseSwitchSection"),X=n("BaseSettingCard");return p(),y(X,{title:e.$t("settings.tax_types.title"),description:e.$t("settings.tax_types.description")},N({default:t(()=>[s(J),s(g,{ref_key:"table",ref:l,class:"mt-16",data:C,columns:E.value},N({"cell-percent":t(({row:u})=>[w(D(u.data.percent)+" % ",1)]),_:2},[d()?{name:"cell-actions",fn:t(({row:u})=>[s(Q,{row:u.data,table:l.value,"load-data":h},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"]),i(f).currentUser.is_owner?(p(),K("div",W,[s(L,{class:"mt-8 mb-2"}),s(O,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=u=>o.value=u),disabled:r.value,title:e.$t("settings.tax_types.tax_per_item"),description:e.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"])])):P("",!0)]),_:2},[i(f).hasAbilities(i(T).CREATE_TAX_TYPE)?{name:"action",fn:t(()=>[s(k,{type:"submit",variant:"primary-outline",onClick:I},{left:t(u=>[s(_,{class:G(u.class),name:"PlusIcon"},null,8,["class"])]),default:t(()=>[w(" "+D(e.$t("settings.tax_types.add_new_tax")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"])}}};export{te as default};
