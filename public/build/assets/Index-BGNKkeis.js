import{v as M,j as v,r as l,c as r,o as n,L as y,b as a,t as d,a as e,l as i,a0 as J,K as w,w as m,aw as K,H as O,e as k,i as Q,f as j,J as W,g as X,Q as Y,R as Z,m as ee,q as P,M as te}from"./main-DlOnIu1m.js";const ae={key:0,class:"absolute mt-5 px-6 w-full flex justify-end"},se={key:0,class:"bg-white bg-opacity-75 text-xs px-3 py-1 font-semibold tracking-wide rounded"},ne={key:1,class:"ml-2 bg-white bg-opacity-75 text-xs px-3 py-1 font-semibold tracking-wide rounded"},le={key:0},oe={key:1},re=["src"],ie={class:"px-6 py-5 flex flex-col bg-gray-50 flex-1 justify-between"},de={class:"text-lg sm:text-2xl font-medium whitespace-nowrap truncate text-primary-500"},ce={key:0,class:"flex items-center mt-2"},ue=["src"],me={class:"ml-2 text-base font-semibold truncate"},_e={class:"flex justify-between mt-4 flex-col space-y-2 sm:space-y-0 sm:flex-row"},he={class:"text-xl md:text-2xl font-semibold whitespace-nowrap text-primary-500"},pe={__name:"ModuleCard",props:{data:{type:Object,default:null,required:!0}},setup(s){const{t:o}=M.useI18n(),h=s;let c=v(()=>parseInt(h.data.average_rating));return(_,u)=>{const g=l("base-text"),x=l("BaseRating");return n(),r("div",{class:"relative shadow-md border-2 border-gray-200 border-opacity-60 rounded-lg cursor-pointer overflow-hidden h-100",onClick:u[0]||(u[0]=I=>_.$router.push(`/admin/modules/${s.data.slug}`))},[s.data.purchased?(n(),r("div",ae,[s.data.purchased?(n(),r("label",se,d(_.$t("modules.purchased")),1)):y("",!0),s.data.installed?(n(),r("label",ne,[s.data.update_available?(n(),r("span",le,d(_.$t("modules.update_available")),1)):(n(),r("span",oe,d(_.$t("modules.installed")),1))])):y("",!0)])):y("",!0),a("img",{class:"lg:h-64 md:h-48 w-full object-cover object-center",src:s.data.cover,alt:"cover"},null,8,re),a("div",ie,[a("span",de,d(s.data.name),1),s.data.author_avatar?(n(),r("div",ce,[a("img",{class:"hidden h-10 w-10 rounded-full sm:inline-block mr-2",src:s.data.author_avatar?s.data.author_avatar:"http://localhost:3000$images/default-avatar.jpg",alt:""},null,8,ue),u[1]||(u[1]=a("span",null,"by",-1)),a("span",me,d(s.data.author_name),1)])):y("",!0),e(g,{text:s.data.short_description,class:"pt-4 text-gray-500 h-16 line-clamp-2"},null,8,["text"]),a("div",_e,[a("div",null,[e(x,{rating:i(c)},null,8,["rating"])]),a("div",he," $ "+d(s.data.monthly_price?s.data.monthly_price/100:s.data.yearly_price/100),1)])])])}}},fe={},ge={class:"shadow-md border-2 border-gray-200 border-opacity-60 rounded-lg cursor-pointer overflow-hidden h-100"},ve={class:"px-6 py-5 flex flex-col bg-gray-50 flex-1 justify-between"},be={class:"flex items-center mt-2"},ye={class:"flex justify-between mt-4 flex-col space-y-2 sm:space-y-0 sm:flex-row"};function xe(s,o){const h=l("BaseContentPlaceholdersBox"),c=l("BaseContentPlaceholdersText"),_=l("BaseContentPlaceholders");return n(),w(_,null,{default:m(()=>[a("div",ge,[e(h,{class:"h-48 lg:h-64 md:h-48 w-full",rounded:""}),a("div",ve,[e(c,{class:"w-32 h-8",lines:1,rounded:""}),a("div",be,[e(h,{class:"h-10 w-10 rounded-full sm:inline-block mr-2"}),a("div",null,[e(c,{class:"w-32 h-8 ml-2",lines:1,rounded:""})])]),e(c,{class:"pt-4 w-full h-16",lines:1,rounded:""}),a("div",ye,[e(c,{class:"w-32 h-8",lines:1,rounded:""}),e(c,{class:"w-32 h-8",lines:1,rounded:""})])])])]),_:1})}const B=J(fe,[["render",xe]]),$e={key:0},ke={key:0,class:"grid mt-6 w-full grid-cols-1 items-start gap-6 lg:grid-cols-2 xl:grid-cols-3"},Be={key:1},we={key:0,class:"grid mt-6 w-full grid-cols-1 items-start gap-6 lg:grid-cols-2 xl:grid-cols-3"},Ie={key:1,class:"mt-24"},Te={class:"flex items-center justify-center text-gray-500"},Ce={class:"text-gray-900 text-lg font-medium"},Se={class:"mt-1 text-sm text-gray-500"},je={class:"grid lg:grid-cols-2 mt-6"},Pe={class:"flex space-x-2"},Me=["href"],Ve={__name:"Index",setup(s){const o=K(),h=O(),c=k(""),{t:_}=M.useI18n();let u=k(!1),g=k(!1);const x=v(()=>({api_token:{required:j.withMessage(_("validation.required"),X),minLength:j.withMessage(_("validation.name_min_length",{count:3}),W(3))}})),I=v(()=>o.apiToken?(L(),!0):!1),p=Q(x,v(()=>o.currentUser)),$=v(()=>c.value==="INSTALLED"?o.modules.filter(t=>t.installed):o.modules);async function L(){g.value=!0,await o.fetchModules().then(()=>{g.value=!1})}async function V(){if(p.value.$touch(),p.value.$invalid)return!0;u.value=!0,o.checkApiToken(o.currentUser.api_token).then(t=>{if(t.data.success){U();return}u.value=!1})}async function U(){try{await h.updateGlobalSettings({data:{settings:{api_token:o.currentUser.api_token}},message:"settings.preferences.updated_message"}).then(t=>{if(t.data.success){o.apiToken=o.currentUser.api_token;return}}),u.value=!1}catch(t){u.value=!1,console.error(t);return}}function q(t){c.value=t.filter}return(t,b)=>{const T=l("BaseBreadcrumbItem"),A=l("BaseBreadcrumb"),G=l("BasePageHeader"),C=l("BaseTab"),N=l("BaseTabGroup"),D=l("BaseInput"),E=l("BaseInputGroup"),R=l("BaseIcon"),S=l("BaseButton"),F=l("BaseCard"),H=l("BasePage");return n(),w(H,null,{default:m(()=>[e(G,{title:t.$t("modules.title")},{default:m(()=>[e(A,null,{default:m(()=>[e(T,{title:t.$t("general.home"),to:"dashboard"},null,8,["title"]),e(T,{title:t.$t("modules.module",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),I.value&&i(o).modules?(n(),r("div",$e,[e(N,{class:"-mb-5",onChange:q},{default:m(()=>[e(C,{title:t.$t("general.all"),filter:""},null,8,["title"]),e(C,{title:t.$t("modules.installed"),filter:"INSTALLED"},null,8,["title"])]),_:1}),i(g)?(n(),r("div",ke,[e(B),e(B),e(B)])):(n(),r("div",Be,[$.value&&$.value.length?(n(),r("div",we,[(n(!0),r(Y,null,Z($.value,(f,z)=>(n(),r("div",{key:z},[e(pe,{data:f},null,8,["data"])]))),128))])):(n(),r("div",Ie,[a("label",Te,d(t.$t("modules.no_modules_installed")),1)]))]))])):(n(),w(F,{key:1,class:"mt-6"},{default:m(()=>[a("h6",Ce,d(t.$t("modules.connect_installation")),1),a("p",Se,d(t.$t("modules.api_token_description",{url:i(h).config.base_url.replace(/^http:\/\//,"")})),1),a("div",je,[a("form",{action:"",class:"mt-6",onSubmit:ee(V,["prevent"])},[e(E,{label:t.$t("modules.api_token"),required:"",error:i(p).api_token.$error&&i(p).api_token.$errors[0].$message},{default:m(()=>[e(D,{modelValue:i(o).currentUser.api_token,"onUpdate:modelValue":b[0]||(b[0]=f=>i(o).currentUser.api_token=f),invalid:i(p).api_token.$error,onInput:b[1]||(b[1]=f=>i(p).api_token.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a("div",Pe,[e(S,{class:"mt-6",loading:i(u),type:"submit"},{left:m(f=>[e(R,{name:"SaveIcon",class:te(f.class)},null,8,["class"])]),default:m(()=>[P(" "+d(t.$t("general.save")),1)]),_:1},8,["loading"]),a("a",{href:`${i(h).config.base_url}/auth/customer/register`,class:"mt-6 block",target:"_blank"},[e(S,{variant:"primary-outline",type:"button"},{default:m(()=>[P(d(t.$t("modules.sign_up_and_get_token")),1)]),_:1})],8,Me)])],32)])]),_:1}))]),_:1})}}};export{Ve as default};
